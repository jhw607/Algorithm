```python3
import math

def cal(fees, time_gap):
    basic_t, basic_c, add_t, add_c = fees

    if time_gap <= basic_t:
        return basic_c
    else:
        return (basic_c + math.ceil((time_gap - basic_t)/add_t) * add_c)
        
def solution(fees, records):  
    temp = {}
    temp_c = {}
    temp_t = {}
    answer = []
    for record in records:
        time, car_number, is_inout = record.split()
        h, m = map(int, time.split(':'))
        time = 60 * h + m
            
        if is_inout == 'IN':
            temp[car_number] = time
        else:
            time_in = temp[car_number]
            temp[car_number] = 0
            time_gap = time - time_in
            
            if car_number not in temp_t:
                temp_t[car_number] = time_gap
            else:
                temp_t[car_number] += time_gap
            
    for car in temp:
        last_time = 23 * 60 + 59
        time_in = temp[car]
        time_gap = last_time - time_in
            
        if time_in != 0:
            if car not in temp_t:
                temp_t[car] = time_gap
            else:
                temp_t[car] += time_gap
            
    for car in temp_t:
        cost = cal(fees, temp_t[car])
        temp_c[car_number] = cost
        
    print(temp_c)
    return answer

```
